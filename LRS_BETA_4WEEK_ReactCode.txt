import React, { useState } from 'react';
import { BookOpen, Brain, Activity, Shield, ChevronRight, Printer, ArrowLeft, Leaf, AlertCircle, Heart, Zap, Lock, Globe, User, Target, Scale, Eye } from 'lucide-react';
import jsPDF from 'jspdf';

const schemas = [
  {
    id: 1,
    category: "Disconnection & Rejection",
    name: "Abandonment / Instability",
    causes: "Unstable or unreliable caregiving; early loss or parent absence.",
    symptoms: "Intense fear of loss, clinginess, jealousy, or withdrawal.",
    manifestations: "Connection (attachment worry), Roots (parent loss), Stability (world anxiety)",
    evidence: "Based on Young Schema Therapy (2003) and Attachment Theory.",
    plan: {
      week1: "Trigger Mapping: Record every time you feel 'abandonment panic'. Note the objective trigger vs. the internal fear (e.g., 'They are busy' vs 'They are leaving').",
      week2: "The Healthy Adult Voice: Practice the thought: 'I am an adult now. Even if this person leaves, I have the skills to care for myself.'",
      week3: "Planned Separation: Spend an evening alone without checking social media or location of loved ones. Practice self-soothing in the silence.",
      week4: "Relapse Prevention: Identify 3 healthy ways to ask for reassurance without testing or accusing your partner."
    }
  },
  {
    id: 2,
    category: "Disconnection & Rejection",
    name: "Mistrust / Abuse",
    causes: "Abuse, betrayal, or manipulation by caregivers or peers.",
    symptoms: "Expectation of harm, hypervigilance, difficulty trusting, testing others.",
    manifestations: "Roots (trauma items), Connection (trust difficulty), Environment (safety concerns)",
    evidence: "Based on Trauma-Informed CBT and Schema Therapy protocols.",
    plan: {
      week1: "Evidence Checking: Pick one person you distrust. List evidence 'for' and 'against' the belief that they intend to harm you.",
      week2: "Boundary Training: Practice saying 'I’m not comfortable with that' to minor requests to build a sense of internal safety.",
      week3: "Vulnerability Experiment: Share one minor personal opinion with a safe person. Observe that the information was not used against you.",
      week4: "Trust Pacing: Categorize people into 'Trust Levels' (1-5). Practice sharing only level-appropriate info with each."
    }
  },
  {
    id: 3,
    category: "Disconnection & Rejection",
    name: "Emotional Deprivation",
    causes: "Lack of nurturance, empathy, or affection from caregivers.",
    symptoms: "Feeling chronically lonely, 'no one is there for me', choosing distant partners.",
    manifestations: "Connection (closeness), Roots (neglect), Vitality (mood)",
    evidence: "Based on Emotion-Focused Therapy and Young’s Schema models.",
    plan: {
      week1: "Need Awareness: Use a 'Need Diary'. Every time you feel empty, write down what you needed: Empathy, Protection, or Nurturance.",
      week2: "Cognitive Flashcard: Create a card: 'My feeling that no one cares is a schema memory, not a current fact.' Carry it with you.",
      week3: "Active Request: Ask a trusted person for 10 minutes of active listening regarding a small stressor. Practice receiving their care.",
      week4: "Inner Nurturing: Schedule one activity weekly that feels 'nurturing' to your inner child (e.g., a warm bath, reading a favorite book)."
    }
  },
  {
    id: 4,
    category: "Disconnection & Rejection",
    name: "Defectiveness / Shame",
    causes: "Criticism, rejection, or shaming; feeling inherently flawed.",
    symptoms: "Deep shame, self-loathing, hypersensitivity to criticism, hiding 'defects'.",
    manifestations: "Digital Wellbeing (comparison), Meaning (self-worth), Roots (insults)",
    evidence: "Inspired by Compassion-Focused Therapy and Neff’s Self-Compassion research.",
    plan: {
      week1: "Critic Audit: Name your inner critic (e.g., 'The Judge'). Note how often it speaks and the specific words it uses to shame you.",
      week2: "Humanity Re-framing: When you make a mistake, say: 'This is a common human experience, not proof of my defectiveness.'",
      week3: "Mirror Work: Spend 2 minutes daily looking at yourself in a mirror while repeating: 'I am worthy of kindness regardless of my flaws.'",
      week4: "Compassionate Letter: Write a letter to yourself from the perspective of a perfectly wise and kind friend, forgiving a past mistake."
    }
  },
  {
    id: 5,
    category: "Disconnection & Rejection",
    name: "Social Isolation / Alienation",
    causes: "Feeling different or excluded from family or peers.",
    symptoms: "Sense of being an outsider, avoiding groups, feeling no one understands.",
    manifestations: "Connection (outsider), Environment (identity), Digital Wellbeing (comparison)",
    evidence: "Based on Social Skills Training and CBT for Social Anxiety.",
    plan: {
      week1: "Similarity Search: In every interaction, find one thing you have in common with the other person, however small.",
      week2: "Cognitive Reframe: Challenge the thought 'They think I'm weird' with 'Most people are too focused on themselves to judge me.'",
      week3: "The Show Up Challenge: Attend one group event (meetup, class, or work lunch) and stay for at least 30 minutes without hiding.",
      week4: "Small Talk Mastery: Initiate one 2-minute conversation with an acquaintance. Practice the 'Ask one, share one' rule."
    }
  },
  {
    id: 6,
    category: "Impaired Autonomy & Performance",
    name: "Dependence / Incompetence",
    causes: "Overprotection or discouragement of independent decision-making.",
    symptoms: "Inability to handle daily tasks alone, excessive need for advice.",
    manifestations: "Growth (agency), Roots (overprotection), Stability (control)",
    evidence: "Based on Behavioral Activation and Autonomy-focused CBT.",
    plan: {
      week1: "Competence Log: Note every task you completed today without asking for help (e.g., driving, cooking, email).",
      week2: "Solo Decision Day: Make 3 small decisions without asking anyone’s opinion (e.g., what to eat, what to wear).",
      week3: "The Technical Challenge: Research and complete one 'adulting' task you usually outsource (e.g., a simple repair or budget).",
      week4: "Independence Leap: Go to a cinema or restaurant alone. Practice being your own source of company and security."
    }
  },
  {
    id: 7,
    category: "Impaired Autonomy & Performance",
    name: "Vulnerability to Harm or Illness",
    causes: "Growing up with fearful parents; exposure to trauma or childhood illness.",
    symptoms: "Chronic worry about catastrophes (medical, financial, or natural).",
    manifestations: "Stability (world anxiety), Vitality (health worry), Roots (childhood fear)",
    evidence: "Based on Exposure Therapy and CBT for Generalized Anxiety.",
    plan: {
      week1: "Probability Check: For your top fear, calculate the statistical likelihood of it happening vs. your emotional feeling of it.",
      week2: "Worry Time: Schedule 15 minutes a day to 'worry'. If a thought occurs outside this time, say 'I'll save that for 5 PM.'",
      week3: "Gradual Exposure: Do one small thing that feels 'risky' (e.g., going for a walk without your phone or trying a new food).",
      week4: "Radical Acceptance: Practice the mantra: 'I cannot control every outcome, but I can handle whatever comes my way.'"
    }
  },
  {
    id: 8,
    category: "Impaired Autonomy & Performance",
    name: "Enmeshment / Undeveloped Self",
    causes: "Over-involved parents who suppressed the child’s individual identity.",
    symptoms: "Lack of identity, feeling empty alone, adopting others' views.",
    manifestations: "Growth (identity), Connection (enmeshment), Roots (controlling parent)",
    evidence: "Based on Bowenian Family Systems and Schema Therapy.",
    plan: {
      week1: "Preference Discovery: For one week, pause before making a choice and ask: 'What do *I* want, regardless of others?'",
      week2: "Separate Interests: Spend 2 hours doing a hobby or activity that your partner/family does *not* participate in.",
      week3: "Opinion Practice: State your preference first in a group setting (e.g., 'I would like to see [Movie]') before others speak.",
      week4: "Values Mapping: List your top 5 personal values. Check if your current schedule reflects *your* values or someone else's."
    }
  },
  {
    id: 9,
    category: "Impaired Autonomy & Performance",
    name: "Failure",
    causes: "Parents who were highly critical of performance or compared you unfavorably.",
    symptoms: "Belief that one is fundamentally less capable than peers; fear of trying.",
    manifestations: "Growth (perfection/failure), Meaning (competence), Roots (criticism)",
    evidence: "Inspired by Dweck’s Growth Mindset and CBT for Low Self-Esteem.",
    plan: {
      week1: "Past Wins List: List 10 times you succeeded in the past. Include 'small' wins like passing a test or learning to drive.",
      week2: "Skill Breakdown: Take one goal you’ve avoided. Break it into 10 tiny, 15-minute steps. Complete step 1 today.",
      week3: "The 'Data' Reframe: When you fail at something, say: 'This is data on how to improve, not proof that I am a failure.'",
      week4: "New Learning: Spend 30 minutes learning a skill you are currently 'bad' at. Practice being a beginner without judgment."
    }
  },
  {
    id: 10,
    category: "Impaired Limits",
    name: "Entitlement / Grandiosity",
    causes: "Spoiling, lack of limits, or being told you are 'special' above others.",
    symptoms: "Insistence on having one's own way, lack of empathy, feeling rules don't apply.",
    manifestations: "Connection (respect), Growth (superiority), Roots (no limits)",
    evidence: "Based on Schema Therapy for Narcissism and DBT interpersonal skills.",
    plan: {
      week1: "Frustration Tolerance: Practice waiting in the longest line at a store without complaining or cutting.",
      week2: "Active Empathy: In every conversation, ask 'How are you feeling?' and listen for 5 minutes without making it about yourself.",
      week3: "The 'Equality' Mantra: Practice the thought: 'Being equal to others is not a demotion; it is the path to real connection.'",
      week4: "Rule Following: Pick one minor rule you usually ignore (e.g., speed limit) and follow it perfectly for 7 days."
    }
  },
  {
    id: 11,
    category: "Impaired Limits",
    name: "Insufficient Self-Control / Self-Discipline",
    causes: "Lack of structure or discipline in childhood; avoidant coping.",
    symptoms: "Difficulty finishing tasks, impulsivity, low frustration tolerance.",
    manifestations: "Vitality (habits), Growth (achievement), Roots (no routine)",
    evidence: "Based on Behavioral Activation and Executive Function coaching.",
    plan: {
      week1: "The One Routine: Choose one 5-minute task (e.g., making the bed) and do it every single day without exception.",
      week2: "The 10-Minute Rule: When you want to quit a difficult task, tell yourself you will do just '10 more minutes' then decide.",
      week3: "Delayed Gratification: When you want an impulsive purchase, wait 24 hours. Note the feeling of the urge passing.",
      week4: "Completion Goal: Pick one small, unfinished project. Spend 30 minutes daily on it until it is 100% finished."
    }
  },
  {
    id: 12,
    category: "Other-Directedness",
    name: "Subjugation",
    causes: "Highly controlling or punitive parents; fear of retaliation.",
    symptoms: "Giving up control to others to avoid conflict; suppressed anger.",
    manifestations: "Connection (suppression), Growth (conflict avoidance), Roots (scary parent)",
    evidence: "Based on Assertiveness Training and Schema-Focused Therapy.",
    plan: {
      week1: "Anger Awareness: Every time you feel 'annoyed', ask: 'What need of mine is being ignored right now?'",
      week2: "The Preference Choice: Practice making the first choice for dinner, a movie, or a walk. Sit with the anxiety of leading.",
      week3: "I-Statement Practice: Use the script: 'I feel [emotion] when [behavior] because [reason].' Practice it on a minor issue.",
      week4: "Small Rebellion: Break one 'internal rule' you have about being 'good' or 'nice' (e.g., leave the dishes for one morning)."
    }
  },
  {
    id: 13,
    category: "Other-Directedness",
    name: "Self-Sacrifice",
    causes: "Taking care of parents; guilt or modeling of excessive giving.",
    symptoms: "Over-focus on others' needs, neglect of own, resentment, burnout.",
    manifestations: "Meaning (helping), Connection (preoccupation), Roots (parentification)",
    evidence: "Based on Boundary Theory and CBT for Burnout.",
    plan: {
      week1: "Resentment Log: Note every time you feel resentful. This is a signal that you have sacrificed too much.",
      week2: "The 'No' Practice: Say 'no' to one non-essential favor this week. Observe that the person survived without you.",
      week3: "Priority Shift: Schedule one hour of 'Me Time' on your calendar. Treat it as a mandatory appointment.",
      week4: "Needs Ranking: List your top 3 physical or emotional needs. Ensure they are met *before* you say yes to others on Tuesday."
    }
  },
  {
    id: 14,
    category: "Other-Directedness",
    name: "Approval-Seeking / Recognition-Seeking",
    causes: "Love and acceptance conditional on performance or appearance.",
    symptoms: "Need for admiration, identity based on validation, conformity.",
    manifestations: "Digital Wellbeing (validation), Meaning (respect), Growth (worth)",
    evidence: "Based on Acceptance and Commitment Therapy (ACT) values work.",
    plan: {
      week1: "The Unseen Act: Do one thing you are proud of this week and tell **no one** about it. Savor the internal pride.",
      week2: "Authenticity Audit: List 3 things you do solely for other people's approval. Pick one and stop doing it for 3 days.",
      week3: "Opinion Sharing: Share an unpopular or controversial opinion in a safe group (e.g., 'I actually don't like that popular show').",
      week4: "Inner Validation: Every night, write down: 'I am proud of myself today because...' without referencing anyone else's opinion."
    }
  },
  {
    id: 15,
    category: "Overvigilance & Inhibition",
    name: "Negativity / Pessimism",
    causes: "Focus on negative in family; repeated childhood hardship.",
    symptoms: "Chronic focus on negatives, worry, discounting positives.",
    manifestations: "Vitality (mood), Stability (anxiety), Meaning (gratitude)",
    evidence: "Based on Seligman’s Learned Optimism and Positive CBT.",
    plan: {
      week1: "Three Good Things: Every night, write down 3 specific things that went well today and *why* they went well.",
      week2: "The Best-Case Scenario: For every 'catastrophe' thought, force yourself to write a 'Best Case' and 'Most Likely' outcome.",
      week3: "Complaint Fast: Try to go 24 hours without voicing a single complaint. Notice how it affects your energy levels.",
      week4: "Optimism Experiment: Take a small leap of faith (e.g., inviting a new person to coffee) and expect a positive outcome."
    }
  },
  {
    id: 16,
    category: "Overvigilance & Inhibition",
    name: "Emotional Inhibition",
    causes: "Suppression of emotions shamed or punished as a child.",
    symptoms: "Restraint of feelings, fear of losing control, rigid/cold appearance.",
    manifestations: "Connection (hiding), Digital Wellbeing (curating), Vitality (mood)",
    evidence: "Based on Emotion-Focused Therapy and Somatic Experiencing.",
    plan: {
      week1: "The Feelings Wheel: Three times a day, look at a feelings wheel and name exactly what you are feeling physically and emotionally.",
      week2: "Body Scanning: When you feel tension, identify where it is (chest, jaw, stomach). Sit with the sensation for 2 minutes.",
      week3: "Spontaneity Minute: Set a timer for 60 seconds and do something 'unstructured' (e.g., dancing, doodling, or making silly noises).",
      week4: "Emotional Disclosure: Share one 'vulnerable' feeling with a loved one (e.g., 'I felt a bit lonely today') without adding logic."
    }
  },
  {
    id: 17,
    category: "Overvigilance & Inhibition",
    name: "Unrelenting Standards / Hypercriticalness",
    causes: "High pressure for performance; criticism for imperfection.",
    symptoms: "Perfectionism, chronic dissatisfaction, burnout, harsh judgment.",
    manifestations: "Growth (perfection), Meaning (peace), Connection (suppression)",
    evidence: "Based on CBT for Perfectionism (Antony & Swinson).",
    plan: {
      week1: "The 80% Experiment: Intentionally complete a low-stakes task (e.g., a simple email or chore) to an 80% standard. Do not 'fix' it.",
      week2: "Savoring Play: Schedule 30 minutes of an activity that has NO goal or achievement attached (e.g., walking without a destination).",
      week3: "Soften the 'Shoulds': Replace 'I should' with 'I would like to' or 'I choose to' in your internal monologue for 48 hours.",
      week4: "Self-Criticism Counter: For every critical thought, write down one thing you appreciate about your effort, not the result."
    }
  },
  {
    id: 18,
    category: "Overvigilance & Inhibition",
    name: "Punitiveness",
    causes: "Harsh punishment; intolerance of mistakes in the home.",
    symptoms: "Self-punishing or punitive toward others, difficulty forgiving errors.",
    manifestations: "Vitality (guilt), Growth (critical mistakes), Roots (cruel discipline)",
    evidence: "Based on Compassion-Focused Therapy and Radical Forgiveness.",
    plan: {
      week1: "The Human Error Rule: When you or someone else makes a mistake, repeat: 'Mistakes are a necessary part of growth, not a crime.'",
      week2: "The Mercy Act: Forgive a minor 'offense' by someone else this week without lecturing them or holding a grudge.",
      week3: "Self-Forgiveness Ritual: Write a mistake you've been punishing yourself for on paper. Literally throw it away and commit to moving on.",
      week4: "Kindness Reward: After a mistake or a hard day, do something kind for yourself (e.g., a small treat) instead of being 'strict'."
    }
  }
];

export default function CompleteSchemaWorkbook() {
  const [selectedSchema, setSelectedSchema] = useState(null);
  const [completedWeeks, setCompletedWeeks] = useState({});

  const handlePrint = () => window.print();

  const handleDownloadPDF = (schema) => {
    const doc = new jsPDF();
    doc.setFontSize(18);
    doc.text(schema.name, 20, 20);
    doc.setFontSize(12);
    doc.text(`Category: ${schema.category}`, 20, 30);
    doc.text(`Root Causes: ${schema.causes}`, 20, 40, { maxWidth: 160 });
    doc.text(`Symptoms: ${schema.symptoms}`, 20, 55, { maxWidth: 160 });
    doc.text(`Manifestations: ${schema.manifestations}`, 20, 70, { maxWidth: 160 });
    doc.text('--- 4-WEEK ACTION PLAN ---', 20, 85);
    doc.text(`Week 1: ${schema.plan.week1}`, 20, 95, { maxWidth: 160 });
    doc.text(`Week 2: ${schema.plan.week2}`, 20, 115, { maxWidth: 160 });
    doc.text(`Week 3: ${schema.plan.week3}`, 20, 135, { maxWidth: 160 });
    doc.text(`Week 4: ${schema.plan.week4}`, 20, 155, { maxWidth: 160 });
    doc.save(`${schema.name.replace(/\//g, '-')}.pdf`);
  };

  const toggleWeekComplete = (schemaId, week) => {
    const key = `${schemaId}-${week}`;
    setCompletedWeeks(prev => ({ ...prev, [key]: !prev[key] }));
  };

  const categoryIcons = {
    "Disconnection & Rejection": Heart,
    "Impaired Autonomy & Performance": User,
    "Impaired Limits": Scale,
    "Other-Directedness": Globe,
    "Overvigilance & Inhibition": Eye
  };

  return (
    <div className="min-h-screen bg-slate-50 font-sans p-4 md:p-12">
      <style>{`
        @media print {
          .print-hide { display: none !important; }
          .print-break { page-break-before: always; }
          body { background: white; }
        }
      `}</style>

      {!selectedSchema ? (
        <div className="max-w-6xl mx-auto">
          <header className="mb-12 text-center">
            <h1 className="text-5xl font-black text-slate-900 mb-4 tracking-tighter uppercase">LRS Clinical Workbook</h1>
            <p className="text-slate-500 text-lg">Comprehensive CBT Action Plans for all 18 Young's Schemas</p>
          </header>
          
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {schemas.map((schema) => {
              const Icon = categoryIcons[schema.category] || Brain;
              return (
                <div 
                  key={schema.id}
                  onClick={() => { setSelectedSchema(schema); window.scrollTo(0, 0); }}
                  className="bg-white p-6 rounded-3xl border border-slate-200 hover:border-blue-500 hover:shadow-2xl transition-all cursor-pointer group"
                >
                  <div className="flex items-center gap-3 mb-4">
                    <div className="p-2 bg-blue-50 rounded-xl text-blue-600 group-hover:bg-blue-600 group-hover:text-white transition-colors">
                      <Icon size={20} />
                    </div>
                    <span className="text-[10px] font-black text-slate-400 uppercase tracking-widest">{schema.category}</span>
                  </div>
                  <h3 className="text-xl font-bold text-slate-800 mb-2">{schema.name}</h3>
                  <p className="text-xs text-slate-500 line-clamp-2 leading-relaxed">{schema.symptoms}</p>
                  <div className="mt-4 flex items-center text-blue-600 font-bold text-xs uppercase tracking-tighter opacity-0 group-hover:opacity-100 transition-opacity">
                    View Action Plan <ChevronRight size={14} />
                  </div>
                </div>
              );
            })}
          </div>
        </div>
      ) : (
        <div className="max-w-4xl mx-auto animate-in fade-in duration-500">
          <button 
            onClick={() => setSelectedSchema(null)}
            className="flex items-center gap-2 text-slate-500 hover:text-blue-600 mb-8 font-bold print-hide"
          >
            <ArrowLeft size={20} /> BACK TO DIRECTORY
          </button>

          <div className="bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-slate-200">
            <div className="bg-slate-900 p-10 text-white">
              <div className="flex justify-between items-start">
                <div>
                  <div className="bg-blue-600 px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest mb-4 inline-block">
                    {selectedSchema.category}
                  </div>
                  <h2 className="text-4xl md:text-5xl font-black mb-3">{selectedSchema.name}</h2>
                  <p className="text-blue-400 font-bold text-sm tracking-widest uppercase">Clinical Reprogramming Protocol</p>
                </div>
                <div className="flex gap-2 print-hide">
                  <button onClick={handlePrint} className="p-4 bg-white/10 hover:bg-white/20 rounded-2xl transition-colors"><Printer size={20} /></button>
                  <button onClick={() => handleDownloadPDF(selectedSchema)} className="p-4 bg-white/10 hover:bg-white/20 rounded-2xl transition-colors"><Shield size={20} /></button>
                </div>
              </div>
            </div>

            <div className="p-10 grid md:grid-cols-3 gap-8 bg-slate-50 border-b border-slate-200">
              <div className="space-y-2">
                <h4 className="flex items-center gap-2 text-red-600 font-black text-[10px] uppercase tracking-widest"><Brain size={16}/> Root Cause</h4>
                <p className="text-sm text-slate-700 leading-relaxed">{selectedSchema.causes}</p>
              </div>
              <div className="space-y-2">
                <h4 className="flex items-center gap-2 text-orange-600 font-black text-[10px] uppercase tracking-widest"><AlertCircle size={16}/> Common Symptoms</h4>
                <p className="text-sm text-slate-700 leading-relaxed">{selectedSchema.symptoms}</p>
              </div>
              <div className="space-y-2">
                <h4 className="flex items-center gap-2 text-purple-600 font-black text-[10px] uppercase tracking-widest"><Activity size={16}/> Life Manifestations</h4>
                <p className="text-sm text-slate-700 leading-relaxed font-medium">{selectedSchema.manifestations}</p>
              </div>
            </div>

            <div className="p-10">
              <div className="mb-10">
                <h3 className="text-3xl font-black text-slate-900 mb-2">Evidence-Based 4-Week Plan</h3>
                <p className="text-slate-500 italic text-sm">{selectedSchema.evidence}</p>
              </div>
              
              <div className="space-y-10">
                {['week1', 'week2', 'week3', 'week4'].map((week, idx) => {
                  const weekTitles = ["Foundation & Awareness", "Cognitive Intervention", "Behavioral Experimentation", "Integration & Mastery"];
                  const Icons = [BookOpen, Brain, Zap, Shield];
                  const ActiveIcon = Icons[idx];
                  const key = `${selectedSchema.id}-${week}`;
                  
                  return (
                    <div key={week} className="flex gap-8 group">
                      <div className="flex flex-col items-center">
                        <div className={`p-4 rounded-2xl transition-all duration-500 ${completedWeeks[key] ? 'bg-green-500 text-white rotate-[360deg]' : 'bg-blue-100 text-blue-600 shadow-sm'}`}>
                          <ActiveIcon size={24} />
                        </div>
                        {idx < 3 && <div className="w-px h-full bg-slate-200 mt-4" />}
                      </div>
                      <div className="pb-10 flex-1">
                        <div className="flex justify-between items-center mb-3">
                          <h4 className={`text-xl font-black uppercase tracking-tight transition-colors ${completedWeeks[key] ? 'text-green-600' : 'text-slate-800'}`}>
                            Week {idx+1}: {weekTitles[idx]}
                          </h4>
                          <label className="flex items-center gap-2 text-[10px] font-black text-slate-400 uppercase cursor-pointer hover:text-blue-600 transition-colors print-hide">
                            <input 
                              type="checkbox"
                              checked={completedWeeks[key] || false}
                              onChange={() => toggleWeekComplete(selectedSchema.id, week)}
                              className="w-5 h-5 rounded-lg border-slate-300 text-blue-600 focus:ring-blue-500 transition-all"
                            />
                            {completedWeeks[key] ? 'COMPLETED' : 'MARK COMPLETE'}
                          </label>
                        </div>
                        <div className={`p-6 rounded-3xl leading-relaxed text-slate-700 transition-all duration-500 border ${completedWeeks[key] ? 'bg-green-50/50 border-green-200 opacity-60' : 'bg-white border-slate-200 shadow-sm'}`}>
                          {selectedSchema.plan[week]}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          </div>
          
          <footer className="mt-12 text-center text-slate-400 text-xs pb-12">
            This workbook is a self-help tool and does not replace professional clinical therapy. 
            If you experience severe distress, please consult a licensed mental health professional.
          </footer>
        </div>
      )}
    </div>
  );
}

// Helper icons for the list view
const Zap = ({ size }) => <Activity size={size} />;